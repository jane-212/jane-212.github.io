<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>当使用cross.rs来跨平台编译时遇到的问题</title><meta content=当使用cross.rs来跨平台编译时遇到的问题 name=title><meta content=Jane name=author><meta content="This is Jane's Blog, share about coding and daily." name=description><meta content=website property=og:type><meta content=/blog/cross/ property=og:url><meta content="Jane's Blog" property=og:site_name><meta content=当使用cross.rs来跨平台编译时遇到的问题 property=og:title><meta content="This is Jane's Blog, share about coding and daily." property=og:description><meta content=/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=/blog/cross/ property=twitter:url><meta content=当使用cross.rs来跨平台编译时遇到的问题 property=twitter:title><meta content="This is Jane's Blog, share about coding and daily." property=twitter:description><meta content=/favicon.ico property=twitter:image><link href=/blog/cross/ rel=canonical><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link href=/atom.xml rel=alternate title=RSS type=application/atom+xml><link href=/css/reset-min.css rel=stylesheet><link href=/css/suCSS-min.css rel=stylesheet><link href=/css/style.css rel=stylesheet><link href=/rss.xml rel=alternate title=RSS type=application/rss+xml><link href=/atom.xml rel=alternate title=RSS type=application/atom+xml><script defer src=/js/script.js></script><body><header><nav id=nav-bar><a href=/> /首页/ </a><a href=/blog/> /文章/ </a><a href=/about/> /关于/ </a></nav></header><main><h1>当使用cross.rs来跨平台编译时遇到的问题</h1><address rel=author><span class=accent-data>Jane</span></address><time datetime=2024-04-23>发布于 <span class=accent-data>2024-04-23</span></time><p>当使用cross.rs来跨平台编译时遇到的问题<p>在使用cross编译时，如果在项目中有如下代码。<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-support z-macro z-rust">env!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>FOO<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>该代码会在编译时寻找名为 <code>FOO</code> 的环境变量，但是cross是在docker中编译的，并不会将环境变量传递到docker中，如果想要指定传递的环境变量，可以在项目的根目录中创建 <code>Cross.toml</code> 文件。<pre class="language-toml z-code" data-lang=toml><code class=language-toml data-lang=toml><span class="z-source z-toml"><span class="z-punctuation z-definition z-table z-begin z-toml">[</span><span class="z-meta z-tag z-table z-toml"><span class="z-entity z-name z-table z-toml">build</span><span class="z-punctuation z-separator z-table z-toml">.</span><span class="z-entity z-name z-table z-toml">env</span></span><span class="z-punctuation z-definition z-table z-end z-toml">]</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">passthrough</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-array z-begin z-toml">[</span><span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>FOO<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-definition z-array z-end z-toml">]</span>
</span></code></pre><p>这样配置后，cross就会在编译时将 <code>FOO</code> 变量传递到docker中。<hr><p class=tags-data><a href=/tags/rust>/rust/</a> <a href=/tags/cross>/cross/</a> <a href=/tags/compile>/compile/</a></p><script async crossorigin data-category=Announcements data-category-id=DIC_kwDOLdGlzs4CjhQ4 data-emit-metadata=0 data-lang=zh-CN data-mapping=pathname data-reactions-enabled=1 data-repo=jane-212/jane-212.github.io data-repo-id=R_kgDOLdGlzg data-strict=1 data-theme=preferred_color_scheme src=https://giscus.app/client.js></script></main>